# AnyMark å¤šæµè§ˆå™¨ä¸Šæ¶æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

AnyMark æ˜¯åŸºäº **Chrome Extension Manifest V3** å¼€å‘çš„æ‰©å±•ï¼Œå¯ä»¥é€‚é…å¤šä¸ªæµè§ˆå™¨å¹³å°ã€‚æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•å°†æ‰©å±•ä¸Šæ¶åˆ°ä¸åŒçš„æµè§ˆå™¨å•†åº—ã€‚

---

## ğŸŒ æ”¯æŒçš„æµè§ˆå™¨

| æµè§ˆå™¨ | å…¼å®¹æ€§ | ä¸Šæ¶éš¾åº¦ | å¸‚åœºä»½é¢ | æ¨èåº¦ |
|--------|--------|----------|----------|--------|
| **Chrome** | âœ… åŸç”Ÿæ”¯æŒ | â­ ç®€å• | 65% | â­â­â­â­â­ |
| **Edge** | âœ… ç›´æ¥å…¼å®¹ | â­ ç®€å• | 5% | â­â­â­â­â­ |
| **Brave** | âœ… ç›´æ¥å…¼å®¹ | â­ ç®€å• | 1% | â­â­â­â­ |
| **Vivaldi** | âœ… ç›´æ¥å…¼å®¹ | â­ ç®€å• | 0.2% | â­â­â­ |
| **Opera** | âœ… ç›´æ¥å…¼å®¹ | â­â­ ä¸­ç­‰ | 1% | â­â­â­ |
| **Firefox** | âš ï¸ éœ€è¦é€‚é… | â­â­â­ ä¸­ç­‰ | 3% | â­â­â­â­ |
| **Safari** | âŒ éœ€é‡å†™ | â­â­â­â­â­ å›°éš¾ | 18% | â­â­ |

---

## âœ… Chromium ç³»æµè§ˆå™¨ï¼ˆç›´æ¥å…¼å®¹ï¼‰

### 1. Microsoft Edge

#### ä¸Šæ¶æ­¥éª¤

1. **è®¿é—® Edge Add-ons å•†åº—**
   - ç½‘å€ï¼šhttps://microsoftedge.microsoft.com/addons
   - ç‚¹å‡» "Publish extensions"

2. **æ³¨å†Œå¼€å‘è€…è´¦å·**
   - ä½¿ç”¨ Microsoft è´¦å·ç™»å½•
   - **æ— éœ€ä»˜è´¹**ï¼ˆä¸ Chrome ä¸åŒï¼‰

3. **å‡†å¤‡æäº¤ææ–™**
   - æ‰©å±•åŒ…ï¼šç›´æ¥ä½¿ç”¨ `dist/` ç›®å½•çš„ ZIP æ–‡ä»¶
   - å›¾æ ‡ï¼š128x128, 48x48, 16x16
   - æˆªå›¾ï¼š1280x800 æˆ– 640x400
   - æè¿°ï¼šæ”¯æŒå¤šè¯­è¨€

4. **æäº¤å®¡æ ¸**
   - å¡«å†™æ‰©å±•ä¿¡æ¯
   - ä¸Šä¼  ZIP æ–‡ä»¶
   - æäº¤å®¡æ ¸ï¼ˆé€šå¸¸ 1-3 å¤©ï¼‰

#### æ³¨æ„äº‹é¡¹

- âœ… Edge å®Œå…¨å…¼å®¹ Chrome Extension Manifest V3
- âœ… æ— éœ€ä¿®æ”¹ä»£ç 
- âœ… å®¡æ ¸é€Ÿåº¦é€šå¸¸æ¯” Chrome å¿«
- âœ… æ— éœ€æ³¨å†Œè´¹

---

### 2. Brave

#### ä¸Šæ¶æ­¥éª¤

1. **è®¿é—® Brave æ‰©å±•å•†åº—**
   - ç½‘å€ï¼šhttps://chrome.google.com/webstore
   - Brave ä½¿ç”¨ Chrome Web Store

2. **æ— éœ€å•ç‹¬ä¸Šæ¶**
   - ç”¨æˆ·å¯ä»¥ç›´æ¥ä» Chrome Web Store å®‰è£…
   - Brave ä¼šè‡ªåŠ¨åŒæ­¥ Chrome æ‰©å±•

#### æ³¨æ„äº‹é¡¹

- âœ… å®Œå…¨å…¼å®¹ Chrome æ‰©å±•
- âœ… æ— éœ€å•ç‹¬æäº¤
- âœ… ç”¨æˆ·å®‰è£…ä½“éªŒä¸ Chrome ç›¸åŒ

---

### 3. Vivaldi

#### ä¸Šæ¶æ­¥éª¤

1. **è®¿é—® Vivaldi æ‰©å±•å•†åº—**
   - ç½‘å€ï¼šhttps://chrome.google.com/webstore
   - Vivaldi ä¹Ÿä½¿ç”¨ Chrome Web Store

2. **æ— éœ€å•ç‹¬ä¸Šæ¶**
   - ç”¨æˆ·å¯ä»¥ç›´æ¥ä» Chrome Web Store å®‰è£…

#### æ³¨æ„äº‹é¡¹

- âœ… å®Œå…¨å…¼å®¹ Chrome æ‰©å±•
- âœ… æ— éœ€å•ç‹¬æäº¤

---

### 4. Opera

#### ä¸Šæ¶æ­¥éª¤

1. **è®¿é—® Opera Add-ons å•†åº—**
   - ç½‘å€ï¼šhttps://addons.opera.com/

2. **æ³¨å†Œå¼€å‘è€…è´¦å·**
   - éœ€è¦ Opera è´¦å·
   - **æ— éœ€ä»˜è´¹**

3. **å‡†å¤‡æäº¤ææ–™**
   - æ‰©å±•åŒ…ï¼šç›´æ¥ä½¿ç”¨ `dist/` ç›®å½•çš„ ZIP æ–‡ä»¶
   - å›¾æ ‡ï¼š128x128, 48x48, 16x16
   - æˆªå›¾ï¼š1280x800 æˆ– 640x400

4. **æäº¤å®¡æ ¸**
   - å¡«å†™æ‰©å±•ä¿¡æ¯
   - ä¸Šä¼  ZIP æ–‡ä»¶
   - æäº¤å®¡æ ¸ï¼ˆé€šå¸¸ 1-2 å¤©ï¼‰

#### æ³¨æ„äº‹é¡¹

- âš ï¸ Opera åŸºäº Chromiumï¼Œä½†å¯èƒ½éœ€è¦å°å¹…è°ƒæ•´
- âš ï¸ æŸäº› API å¯èƒ½ä¸å®Œå…¨æ”¯æŒ
- âœ… å¤§éƒ¨åˆ†åŠŸèƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨

---

## ğŸ¦Š Firefoxï¼ˆéœ€è¦é€‚é…ï¼‰

### å…¼å®¹æ€§åˆ†æ

| åŠŸèƒ½ | Chrome | Firefox | å…¼å®¹æ€§ |
|------|--------|---------|--------|
| Manifest V3 | âœ… | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âš ï¸ |
| Side Panel API | âœ… | âœ… | âœ… |
| Service Worker | âœ… | âœ… | âœ… |
| Storage API | âœ… | âœ… | âœ… |
| Bookmarks API | âœ… | âœ… | âœ… |
| Tabs API | âœ… | âœ… | âœ… |
| Notifications API | âœ… | âœ… | âœ… |
| Context Menus API | âœ… | âœ… | âœ… |
| Alarms API | âœ… | âœ… | âœ… |
| Scripting API | âœ… | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âš ï¸ |

### é€‚é…æ­¥éª¤

#### 1. åˆ›å»º Firefox ä¸“ç”¨ manifest

åˆ›å»º `manifest.firefox.json`ï¼š

```json
{
  "manifest_version": 2,
  "name": "AnyMark - The First Bookmark Agent",
  "version": "1.0.0",
  "description": "AI-powered bookmark manager with smart search and organization",
  "icons": {
    "16": "icon-16.png",
    "48": "icon-48.png",
    "128": "icon-128.png"
  },
  "browser_action": {
    "default_popup": "popup.html",
    "default_title": "AnyMark - Bookmark Freely",
    "default_icon": {
      "16": "icon-16.png",
      "48": "icon-48.png",
      "128": "icon-128.png"
    }
  },
  "background": {
    "scripts": ["background.js"],
    "persistent": false
  },
  "permissions": [
    "bookmarks",
    "storage",
    "tabs",
    "activeTab",
    "notifications",
    "contextMenus",
    "alarms"
  ],
  "optional_permissions": ["<all_urls>"],
  "sidebar_action": {
    "default_panel": "sidebar.html",
    "default_title": "AnyMark"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content-toast.js"],
      "run_at": "document_end"
    },
    {
      "matches": ["<all_urls>"],
      "js": ["content-pixel-buddy.js"],
      "run_at": "document_end"
    }
  ],
  "commands": {
    "quick_save": {
      "suggested_key": {
        "default": "Alt+Shift+S"
      },
      "description": "å¿«é€Ÿæ”¶è—å½“å‰é¡µé¢"
    },
    "open_popup": {
      "suggested_key": {
        "default": "Alt+Shift+D"
      },
      "description": "æ‰“å¼€è¯¦ç»†ä¿å­˜é¢æ¿"
    },
    "open-sidebar-tab": {
      "suggested_key": {
        "default": "Alt+Shift+B"
      },
      "description": "æ‰“å¼€ä¹¦ç­¾ç®¡ç†å™¨"
    }
  }
}
```

#### 2. ä¸»è¦å·®å¼‚

| Chrome (MV3) | Firefox (MV2) | è¯´æ˜ |
|--------------|---------------|------|
| `action` | `browser_action` | ä¾§è¾¹æ å…¥å£ |
| `side_panel` | `sidebar_action` | ä¾§è¾¹æ  API |
| `background.service_worker` | `background.scripts` | åå°è„šæœ¬ |
| `host_permissions` | `optional_permissions` | æƒé™å£°æ˜ |
| `manifest_version: 3` | `manifest_version: 2` | ç‰ˆæœ¬å·®å¼‚ |

#### 3. ä»£ç é€‚é…

**Background Script é€‚é…**

Chrome (MV3):
```typescript
// background/index.ts
chrome.runtime.onInstalled.addListener(() => {
  console.log('AnyMark installed');
});
```

Firefox (MV2):
```typescript
// background.firefox.ts
browser.runtime.onInstalled.addListener(() => {
  console.log('AnyMark installed');
});
```

**ä½¿ç”¨ Polyfill**

å®‰è£… `webextension-polyfill`ï¼š

```bash
npm install webextension-polyfill
```

```typescript
import browser from 'webextension-polyfill';

// ç»Ÿä¸€ä½¿ç”¨ browser API
browser.runtime.onInstalled.addListener(() => {
  console.log('AnyMark installed');
});
```

#### 4. æ„å»ºé…ç½®

ä¿®æ”¹ `vite.config.ts`ï¼š

```typescript
export default defineConfig({
  build: {
    rollupOptions: {
      input: {
        'background': './src/background/index.ts',
        'background.firefox': './src/background/index.firefox.ts',
      }
    }
  }
});
```

#### 5. ä¸Šæ¶æ­¥éª¤

1. **è®¿é—® Firefox Add-ons å•†åº—**
   - ç½‘å€ï¼šhttps://addons.mozilla.org/

2. **æ³¨å†Œå¼€å‘è€…è´¦å·**
   - éœ€è¦ Firefox è´¦å·
   - **æ— éœ€ä»˜è´¹**

3. **å‡†å¤‡æäº¤ææ–™**
   - æ‰©å±•åŒ…ï¼šä½¿ç”¨ Firefox é€‚é…ç‰ˆæœ¬
   - å›¾æ ‡ï¼š128x128, 64x64, 48x48, 32x32, 16x16
   - æˆªå›¾ï¼š1280x800 æˆ– 640x400
   - æºä»£ç ï¼šå¿…é¡»æä¾›ï¼ˆFirefox è¦æ±‚ï¼‰

4. **æäº¤å®¡æ ¸**
   - å¡«å†™æ‰©å±•ä¿¡æ¯
   - ä¸Šä¼ æ‰©å±•åŒ…å’Œæºä»£ç 
   - æäº¤å®¡æ ¸ï¼ˆé€šå¸¸ 3-7 å¤©ï¼‰

#### æ³¨æ„äº‹é¡¹

- âš ï¸ Firefox ä»åœ¨é€æ­¥æ”¯æŒ Manifest V3
- âš ï¸ éœ€è¦æä¾›æºä»£ç 
- âš ï¸ å®¡æ ¸æ—¶é—´è¾ƒé•¿
- âš ï¸ æŸäº› API å¯èƒ½ä¸å®Œå…¨æ”¯æŒ

---

## ğŸ Safariï¼ˆéœ€è¦é‡å†™ï¼‰

### å…¼å®¹æ€§åˆ†æ

| åŠŸèƒ½ | Chrome | Safari | å…¼å®¹æ€§ |
|------|--------|--------|--------|
| Extension API | âœ… | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âŒ |
| Side Panel | âœ… | âŒ ä¸æ”¯æŒ | âŒ |
| Service Worker | âœ… | âŒ ä¸æ”¯æŒ | âŒ |
| Bookmarks API | âœ… | âŒ ä¸æ”¯æŒ | âŒ |

### ä¸ºä»€ä¹ˆä¸å»ºè®®

- âŒ Safari ä¸æ”¯æŒ Side Panel API
- âŒ Safari ä¸æ”¯æŒ Service Worker
- âŒ Safari ä¸æ”¯æŒ Bookmarks API
- âŒ éœ€è¦ä½¿ç”¨åŸç”Ÿ Swift/Objective-C é‡å†™
- âŒ å¼€å‘æˆæœ¬æé«˜

### æ›¿ä»£æ–¹æ¡ˆ

å¦‚æœéœ€è¦æ”¯æŒ Safariï¼Œå¯ä»¥è€ƒè™‘ï¼š

1. **ä½¿ç”¨ Safari App Extension**
   - éœ€è¦ä½¿ç”¨ Xcode å¼€å‘
   - éœ€è¦è‹¹æœå¼€å‘è€…è´¦å·ï¼ˆ$99/å¹´ï¼‰
   - åŠŸèƒ½å—é™

2. **æä¾› Web ç‰ˆæœ¬**
   - ä½œä¸ºç‹¬ç«‹ Web åº”ç”¨
   - é€šè¿‡ä¹¦ç­¾æˆ–å¿«æ·æ–¹å¼è®¿é—®
   - åŠŸèƒ½å¯èƒ½å—é™

---

## ğŸ“Š ä¸Šæ¶ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å®æ–½ï¼‰

| æµè§ˆå™¨ | é¢„ä¼°å·¥ä½œé‡ | é¢„æœŸæ”¶ç›Š | æ¨èåº¦ |
|--------|-----------|----------|--------|
| **Chrome** | 0 å°æ—¶ | é«˜ç”¨æˆ·é‡ | â­â­â­â­â­ |
| **Edge** | 0.5 å°æ—¶ | ä¸­ç­‰ç”¨æˆ·é‡ | â­â­â­â­â­ |

### ç¬¬äºŒé˜¶æ®µï¼ˆè¿‘æœŸå®æ–½ï¼‰

| æµè§ˆå™¨ | é¢„ä¼°å·¥ä½œé‡ | é¢„æœŸæ”¶ç›Š | æ¨èåº¦ |
|--------|-----------|----------|--------|
| **Firefox** | 8-16 å°æ—¶ | ä¸­ç­‰ç”¨æˆ·é‡ | â­â­â­â­ |

### ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸè€ƒè™‘ï¼‰

| æµè§ˆå™¨ | é¢„ä¼°å·¥ä½œé‡ | é¢„æœŸæ”¶ç›Š | æ¨èåº¦ |
|--------|-----------|----------|--------|
| **Opera** | 1-2 å°æ—¶ | ä½ç”¨æˆ·é‡ | â­â­â­ |
| **Safari** | 40-80 å°æ—¶ | é«˜ç”¨æˆ·é‡ | â­â­ |

---

## ğŸš€ å¿«é€Ÿä¸Šæ¶æ¸…å•

### Chromium ç³»ï¼ˆChrome + Edgeï¼‰

- [ ] æ„å»º Chrome ç‰ˆæœ¬ï¼š`npm run build`
- [ ] å‡†å¤‡ Chrome å•†åº—ææ–™ï¼ˆè§ `CHROME_STORE_PREPARATION.md`ï¼‰
- [ ] æäº¤ Chrome Web Store å®¡æ ¸
- [ ] Chrome å®¡æ ¸é€šè¿‡åï¼Œç›´æ¥æäº¤ Edge å•†åº—
- [ ] Braveã€Vivaldi ç”¨æˆ·å¯ç›´æ¥ä» Chrome å•†åº—å®‰è£…

### Firefox

- [ ] åˆ›å»º `manifest.firefox.json`
- [ ] é€‚é… background script
- [ ] å®‰è£… `webextension-polyfill`
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- [ ] å‡†å¤‡ Firefox å•†åº—ææ–™
- [ ] æäº¤ Firefox Add-ons å®¡æ ¸

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ç‰ˆæœ¬ç®¡ç†

å»ºè®®ä½¿ç”¨ä¸åŒçš„ç‰ˆæœ¬å·ï¼š

```json
// Chrome
"version": "1.0.0"

// Firefox
"version": "1.0.0.1"
```

### 2. ç»Ÿä¸€æ„å»ºæµç¨‹

åˆ›å»ºæ„å»ºè„šæœ¬ï¼š

```json
{
  "scripts": {
    "build": "vite build",
    "build:chrome": "vite build",
    "build:firefox": "cross-env BROWSER=firefox vite build",
    "build:all": "npm run build:chrome && npm run build:firefox"
  }
}
```

### 3. åŠŸèƒ½é™çº§

å¯¹äºä¸æ”¯æŒçš„ APIï¼Œæä¾›é™çº§æ–¹æ¡ˆï¼š

```typescript
// Side Panel é™çº§
if (chrome.sidePanel) {
  chrome.sidePanel.open();
} else {
  // ä½¿ç”¨ popup æˆ–æ–°æ ‡ç­¾é¡µ
  chrome.tabs.create({ url: 'sidebar.html' });
}
```

### 4. ç»Ÿä¸€æ›´æ–°ç»´æŠ¤

- ä¿æŒ Chrome å’Œ Firefox ç‰ˆæœ¬åŠŸèƒ½åŒæ­¥
- å®šæœŸæ£€æŸ¥å„æµè§ˆå™¨çš„ API æ›´æ–°
- åŠæ—¶ä¿®å¤å…¼å®¹æ€§é—®é¢˜

---

## ğŸ“ å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Chrome Extension Docs](https://developer.chrome.com/docs/extensions/)
- [Firefox Extension Docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions)
- [Edge Extension Docs](https://learn.microsoft.com/en-us/microsoft-edge/extensions-chromium/)

### å·¥å…·

- [webextension-polyfill](https://github.com/mozilla/webextension-polyfill)
- [Extension Automator](https://github.com/GoogleChromeLabs/extension-automator)

---

## âœ… æ€»ç»“

### å¯ä»¥ç›´æ¥ä¸Šæ¶ï¼ˆæ— éœ€ä¿®æ”¹ä»£ç ï¼‰
- âœ… Chrome
- âœ… Edge
- âœ… Brave
- âœ… Vivaldi

### éœ€è¦å°å¹…é€‚é…
- âš ï¸ Firefoxï¼ˆ8-16 å°æ—¶å·¥ä½œé‡ï¼‰

### ä¸æ¨è
- âŒ Operaï¼ˆç”¨æˆ·é‡ä½ï¼‰
- âŒ Safariï¼ˆéœ€è¦å®Œå…¨é‡å†™ï¼‰

### æ¨èä¸Šæ¶é¡ºåº
1. **Chrome** â†’ 2. **Edge** â†’ 3. **Firefox**

è¿™æ ·å¯ä»¥è¦†ç›–çº¦ 73% çš„æµè§ˆå™¨å¸‚åœºä»½é¢ã€‚
