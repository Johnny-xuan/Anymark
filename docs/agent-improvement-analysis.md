# Agent æ”¹è¿›åˆ†ææŠ¥å‘Š

åŸºäºçœŸå®ç”¨æˆ·åœºæ™¯æµ‹è¯•ï¼Œå‘ç°ä»¥ä¸‹é—®é¢˜å’Œæ”¹è¿›å»ºè®®ã€‚

## æµ‹è¯•åœºæ™¯

æ¨¡æ‹Ÿä¸€ä¸ªä¹¦ç­¾æ··ä¹±çš„ç”¨æˆ·ï¼š
- 19 ä¸ªä¹¦ç­¾åˆ†æ•£åœ¨ 11 ä¸ªæ–‡ä»¶å¤¹
- 6 ä¸ªä¹¦ç­¾ä»æœªè®¿é—®è¿‡
- æœ‰é‡å¤æ”¶è—çš„å†…å®¹
- æœ‰è¿‡æ—¶çš„æŠ€æœ¯ä¹¦ç­¾ï¼ˆjQueryã€AngularJS 1.xï¼‰

## å‘ç°çš„é—®é¢˜

### 1. å›å¤ä¸å®Œæ•´
Agent ç»å¸¸è¯´"è®©æˆ‘å†æœç´¢ä¸€ä¸‹"ä½†æ²¡æœ‰ç»§ç»­æ‰§è¡Œï¼Œå¯¼è‡´å›å¤è¢«æˆªæ–­ã€‚

**åŸå› **: Agent æƒ³è°ƒç”¨å¤šä¸ªå·¥å…·ä½†è¢«é™åˆ¶ï¼Œæˆ–è€…åœ¨æ–‡æœ¬ä¸­å†™äº†ä¼ªå·¥å…·è°ƒç”¨ã€‚

**å»ºè®®**: 
- ä¼˜åŒ– System Promptï¼Œå¼ºè°ƒ"ä¸€æ¬¡å·¥å…·è°ƒç”¨åç›´æ¥æ€»ç»“ç»“æœ"
- å¢åŠ å·¥å…·çš„è¿”å›ä¿¡æ¯ä¸°å¯Œåº¦ï¼Œå‡å°‘éœ€è¦å¤šæ¬¡è°ƒç”¨çš„æƒ…å†µ

### 2. å·¥å…·é€‰æ‹©ä¸å¤Ÿç²¾å‡†

| ç”¨æˆ·æ„å›¾ | æœŸæœ›å·¥å…· | å®é™…è°ƒç”¨ |
|---------|---------|---------|
| æ‰¾é‡å¤ä¹¦ç­¾ | organize(findDuplicates) | context(overview) |
| æ‰¾æœªè®¿é—®ä¹¦ç­¾ | search(unvisited filter) | context(stats) |
| æ‰¾æ˜Ÿæ ‡ä¹¦ç­¾ | search(starred filter) | context(overview) |
| æ•´ç†ä¹¦ç­¾ | organize(suggest) | context(overview) |

**åŸå› **: å·¥å…·æè¿°ä¸å¤Ÿæ¸…æ™°ï¼ŒAgent ä¸çŸ¥é“å“ªä¸ªå·¥å…·èƒ½åšä»€ä¹ˆã€‚

**å»ºè®®**:
- åœ¨å·¥å…·æè¿°ä¸­æ·»åŠ æ›´å¤š"ä½•æ—¶ä½¿ç”¨"çš„ç¤ºä¾‹
- æ·»åŠ ä¸“é—¨çš„ `analyze` å·¥å…·ç”¨äºåˆ†æä¹¦ç­¾åº“é—®é¢˜

### 3. ç¼ºå°‘å…³é”®åŠŸèƒ½

å½“å‰ç¼ºå°‘çš„åŠŸèƒ½ï¼š
- **æŸ¥æ‰¾é‡å¤ä¹¦ç­¾** - éœ€è¦ä¸“é—¨çš„ action
- **æŸ¥æ‰¾æœªè®¿é—®ä¹¦ç­¾** - search å·¥å…·éœ€è¦æ”¯æŒ unvisited è¿‡æ»¤
- **æŸ¥æ‰¾è¿‡æ—¶ä¹¦ç­¾** - éœ€è¦åŸºäºæ ‡ç­¾æˆ–æ—¶é—´çš„è¿‡æ»¤
- **æ‰¹é‡æ¸…ç†** - ä¸€é”®æ¸…ç†é‡å¤/è¿‡æ—¶ä¹¦ç­¾

### 4. æœç´¢ç»“æœä¿¡æ¯ä¸è¶³

å½“å‰æœç´¢ç»“æœç¼ºå°‘ï¼š
- æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆç”¨æˆ·æœ€å…³å¿ƒ"åœ¨å“ª"ï¼‰
- è®¿é—®æ¬¡æ•°ï¼ˆåˆ¤æ–­æ˜¯å¦å¸¸ç”¨ï¼‰
- æ”¶è—æ—¶é—´ï¼ˆåˆ¤æ–­æ˜¯å¦è¿‡æ—¶ï¼‰


## æ”¹è¿›æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: å¢å¼º search å·¥å…·

```typescript
// æ·»åŠ æ›´å¤šè¿‡æ»¤å™¨
filters: {
  starred: boolean,      // åªæœç´¢æ˜Ÿæ ‡
  unvisited: boolean,    // åªæœç´¢ä»æœªè®¿é—®
  folder: string,        // æŒ‰æ–‡ä»¶å¤¹è¿‡æ»¤
  olderThan: number,     // è¶…è¿‡ N å¤©æœªè®¿é—®
  tags: string[],        // æŒ‰æ ‡ç­¾è¿‡æ»¤
}
```

### æ–¹æ¡ˆ2: å¢å¼º organize å·¥å…·

```typescript
// æ·»åŠ åˆ†æåŠŸèƒ½
action: 'analyze' | 'suggest' | 'move' | 'cleanup'

// analyze è¿”å›
{
  duplicates: [...],      // é‡å¤ä¹¦ç­¾
  unvisited: [...],       // ä»æœªè®¿é—®
  outdated: [...],        // å¯èƒ½è¿‡æ—¶ï¼ˆåŸºäºæ ‡ç­¾å¦‚ jQueryï¼‰
  scattered: [...],       // åŒç±»åˆ†æ•£
}
```

### æ–¹æ¡ˆ3: ä¼˜åŒ– System Prompt

```
## å·¥å…·ä½¿ç”¨æŒ‡å—

ç”¨æˆ·è¯´"æ‰¾é‡å¤" â†’ organize({ action: 'analyze' })
ç”¨æˆ·è¯´"æ²¡çœ‹è¿‡çš„" â†’ search({ filters: { unvisited: true } })
ç”¨æˆ·è¯´"æ˜Ÿæ ‡/é‡è¦çš„" â†’ search({ filters: { starred: true } })
ç”¨æˆ·è¯´"æ•´ç†/æ¸…ç†" â†’ organize({ action: 'suggest' })
ç”¨æˆ·è¯´"åœ¨å“ª/æ‰¾ä¸åˆ°" â†’ search({ query: ... })
```

### æ–¹æ¡ˆ4: å¢åŠ  analyze å·¥å…·ï¼ˆæ–°å·¥å…·ï¼‰

ä¸“é—¨ç”¨äºåˆ†æä¹¦ç­¾åº“é—®é¢˜ï¼š

```typescript
const analyzeTool: Tool = {
  name: 'analyze',
  description: 'åˆ†æä¹¦ç­¾åº“é—®é¢˜ï¼ˆé‡å¤ã€æœªè®¿é—®ã€è¿‡æ—¶ã€åˆ†æ•£ï¼‰',
  parameters: {
    type: 'object',
    properties: {
      checks: {
        type: 'array',
        items: {
          type: 'string',
          enum: ['duplicates', 'unvisited', 'outdated', 'scattered', 'all']
        }
      }
    }
  }
}
```

## ä¼˜å…ˆçº§å»ºè®®

1. **P0 - ç«‹å³ä¿®å¤**
   - ä¼˜åŒ– System Promptï¼Œå‡å°‘"è®©æˆ‘å†æœç´¢"çš„æƒ…å†µ
   - search å·¥å…·æ·»åŠ  starred å’Œ unvisited è¿‡æ»¤å™¨

2. **P1 - çŸ­æœŸæ”¹è¿›**
   - organize å·¥å…·æ·»åŠ  analyze action
   - æœç´¢ç»“æœæ˜¾ç¤ºæ–‡ä»¶å¤¹è·¯å¾„å’Œè®¿é—®æ¬¡æ•°

3. **P2 - ä¸­æœŸå¢å¼º**
   - æ·»åŠ ç‹¬ç«‹çš„ analyze å·¥å…·
   - æ”¯æŒæ‰¹é‡æ¸…ç†æ“ä½œ
   - æ·»åŠ "è¿‡æ—¶"æ£€æµ‹ï¼ˆåŸºäºæ ‡ç­¾å’Œæ—¶é—´ï¼‰

## æµ‹è¯•éªŒè¯

æ”¹è¿›åéœ€è¦é‡æ–°æµ‹è¯•ä»¥ä¸‹åœºæ™¯ï¼š
1. âœ… æ‰¾é‡å¤ä¹¦ç­¾ â†’ åº”è¯¥ç›´æ¥è¿”å›é‡å¤åˆ—è¡¨
2. âœ… æ‰¾æœªè®¿é—®ä¹¦ç­¾ â†’ åº”è¯¥ç›´æ¥è¿”å›æœªè®¿é—®åˆ—è¡¨
3. âœ… æ‰¾æ˜Ÿæ ‡ä¹¦ç­¾ â†’ åº”è¯¥ç›´æ¥è¿”å›æ˜Ÿæ ‡åˆ—è¡¨
4. âœ… æ•´ç†å»ºè®® â†’ åº”è¯¥è¿”å›å®Œæ•´çš„æ•´ç†æ–¹æ¡ˆ
5. âœ… æ¨¡ç³Šæœç´¢ â†’ åº”è¯¥èƒ½æ‰¾åˆ°ç›¸å…³å†…å®¹å¹¶æ˜¾ç¤ºä½ç½®


## æ”¹è¿›å®æ–½è®°å½•

### å·²å®Œæˆçš„æ”¹è¿› (2024-12-22)

#### 1. å¢å¼º search å·¥å…·
- âœ… æ·»åŠ  `unvisited` è¿‡æ»¤å™¨ - æœç´¢ä»æœªè®¿é—®çš„ä¹¦ç­¾
- âœ… æ·»åŠ  `unusedDays` è¿‡æ»¤å™¨ - æœç´¢è¶…è¿‡ N å¤©æœªè®¿é—®çš„ä¹¦ç­¾
- âœ… æ·»åŠ  `folder` è¿‡æ»¤å™¨ - æŒ‰æ–‡ä»¶å¤¹è·¯å¾„è¿‡æ»¤
- âœ… æ”¯æŒ `query="*"` é€šé…ç¬¦æœç´¢ï¼ˆé…åˆ filters ä½¿ç”¨ï¼‰
- âœ… ç»“æœæ˜¾ç¤ºæ–‡ä»¶å¤¹è·¯å¾„å’Œè®¿é—®æ¬¡æ•°

#### 2. å¢å¼º organize å·¥å…·
- âœ… æ·»åŠ  `analyze` action - åˆ†æä¹¦ç­¾åº“é—®é¢˜
- âœ… æ”¯æŒæŸ¥æ‰¾é‡å¤ä¹¦ç­¾ (findDuplicates)
- âœ… æ”¯æŒæŸ¥æ‰¾æœªè®¿é—®ä¹¦ç­¾ (findUnvisited)
- âœ… æ”¯æŒæŸ¥æ‰¾åŒç±»åˆ†æ•£ä¹¦ç­¾ (findScattered)
- âœ… æ”¯æŒæŸ¥æ‰¾è¿‡æ—¶ä¹¦ç­¾ (findOutdated)
- âœ… ç”Ÿæˆè¯¦ç»†çš„åˆ†ææŠ¥å‘Šå’Œå»ºè®®

#### 3. ä¼˜åŒ– System Prompt
- âœ… æ·»åŠ  Tool Selection Guide
- âœ… æ˜ç¡®æ¯ç§ç”¨æˆ·æ„å›¾å¯¹åº”çš„å·¥å…·å’Œå‚æ•°
- âœ… å¼ºè°ƒ"ä¸€æ¬¡å·¥å…·è°ƒç”¨åç›´æ¥æ€»ç»“"

### æµ‹è¯•ç»“æœå¯¹æ¯”

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å |
|------|--------|--------|
| å·¥å…·é€‰æ‹©å‡†ç¡®ç‡ | ~30% | ~70% |
| å›å¤å®Œæ•´æ€§ | ç»å¸¸æˆªæ–­ | å¤§éƒ¨åˆ†å®Œæ•´ |
| ä¿¡æ¯ä¸°å¯Œåº¦ | ç¼ºå°‘å…³é”®ä¿¡æ¯ | æ˜¾ç¤ºæ–‡ä»¶å¤¹ã€è®¿é—®æ¬¡æ•° |

### ä»éœ€æ”¹è¿›çš„é—®é¢˜

1. **åœºæ™¯2 (ä¹¦ç­¾æ¦‚è§ˆ)** - Agent ä»æƒ³è°ƒç”¨å¤šä¸ªå·¥å…·
   - å»ºè®®ï¼šcontext(overview) è¿”å›æ›´å®Œæ•´çš„ä¿¡æ¯

2. **åœºæ™¯7 (æ‰¾å·¥ä½œä¹¦ç­¾)** - å¤šå…³é”®è¯æœç´¢æ•ˆæœä¸ä½³
   - å»ºè®®ï¼šæ”¯æŒ OR æœç´¢æˆ–æ¨¡ç³ŠåŒ¹é…

3. **åœºæ™¯10 (æ¨¡ç³Šæœç´¢)** - ä¸­æ–‡æè¿°æœç´¢åŒ¹é…é—®é¢˜
   - å»ºè®®ï¼šæ·»åŠ è¯­ä¹‰æœç´¢æˆ–åŒä¹‰è¯åŒ¹é…

### ä¸‹ä¸€æ­¥è®¡åˆ’

1. **P1**: ä¼˜åŒ– context(overview) è¿”å›æ›´å®Œæ•´ä¿¡æ¯
2. **P1**: æ”¹è¿›æœç´¢æ”¯æŒå¤šå…³é”®è¯ OR åŒ¹é…
3. **P2**: æ·»åŠ è¯­ä¹‰æœç´¢èƒ½åŠ›ï¼ˆåŸºäº AI æ ‡ç­¾ï¼‰
4. **P2**: æ·»åŠ æ‰¹é‡æ“ä½œç¡®è®¤æµç¨‹

---

## ç¬¬äºŒè½®æ”¹è¿› (2024-12-22)

### ç”¨æˆ·åé¦ˆ

ç”¨æˆ·æŒ‡å‡ºä¹‹å‰çš„æ”¹è¿›"å¤ªç¡¬ç¼–ç "ï¼ŒSystem Prompt ä¸­çš„ Tool Selection Guide è¿‡åº¦é™åˆ¶äº† Agent çš„è‡ªç„¶è¡Œä¸ºã€‚

> "æ”¹è¿›ä¸èƒ½æ˜¯ç¡¬ç¼–ç ...Agent å°±æ˜¯ä¸€ä¸ªä¹¦ç­¾ç®¡ç†å™¨ AnyMarkï¼Œåº”è¯¥åƒæ­£å¸¸äººä¸€æ ·è¡Œä¸º"
> "è¯¥è§„èŒƒè¿˜å¾—è§„èŒƒï¼Œè¯¥æé†’è¿˜æ˜¯è¦æé†’----æ¯•ç«Ÿå¾—æœ‰å‘˜å·¥åŸ¹è®­å’Œä¼ä¸šå‡†åˆ™å§"

### æ”¹è¿›å†…å®¹

#### 1. ç®€åŒ– System Prompt

**ç§»é™¤**: ç¡¬ç¼–ç çš„ Tool Selection Guideï¼ˆ"ç”¨æˆ·è¯´X â†’ è°ƒç”¨Y"ï¼‰

**ä¿ç•™**:
- Personality - äººæ ¼è®¾å®šï¼ˆå‹å¥½ã€è‡ªç„¶ã€ç¡®è®¤å±é™©æ“ä½œï¼‰
- Tools Overview - å·¥å…·æ¦‚è§ˆï¼ˆç®€è¦è¯´æ˜ç”¨é€”ï¼Œä¸æ˜¯æ˜ å°„è¡¨ï¼‰
- Key Concepts - å…³é”®æ¦‚å¿µï¼ˆChrome vs AI æ–‡ä»¶å¤¹ã€Decay statusã€Frecencyï¼‰
- Important Reminders - é‡è¦æé†’ï¼ˆsearch vs discover åŒºåˆ«ç­‰ï¼‰

#### 2. å¢å¼º search å·¥å…·

æ–°å¢åŠŸèƒ½ï¼š
- `filters.decayStatus` - æŒ‰æ´»è·ƒåº¦è¿‡æ»¤ï¼ˆactive/cooling/cold/frozenï¼‰
- `sortBy` å‚æ•° - æ”¯æŒ relevance/frecency/recent/oldest æ’åº
- ç»“æœæ˜¾ç¤º decay status å›¾æ ‡ï¼ˆğŸŸ¢ğŸŸ¡ğŸ”µâ„ï¸ï¼‰
- ç»“æœåŒ…å« frecency åˆ†æ•°

#### 3. å¢å¼º context(overview)

æ–°å¢å†…å®¹ï¼š
- æ´»è·ƒåº¦åˆ†å¸ƒç»Ÿè®¡ï¼ˆactive/cooling/cold/frozen å„å¤šå°‘ä¸ªï¼‰
- æ¯ä¸ªä¹¦ç­¾æ˜¾ç¤º decay status å›¾æ ‡
- æ™ºèƒ½æç¤ºï¼ˆå¦‚"æœ‰ X ä¸ªä¹¦ç­¾è¶…è¿‡ 90 å¤©æœªè®¿é—®"ï¼‰

### è®¾è®¡ç†å¿µ

- **ä¸ç¡¬ç¼–ç è¡Œä¸º** - è®© LLM è‡ªå·±ç†è§£å·¥å…·æè¿°ï¼Œé€‰æ‹©åˆé€‚çš„å·¥å…·
- **æä¾›è¶³å¤Ÿä¿¡æ¯** - å·¥å…·æè¿°æ¸…æ™°ï¼ŒåŒ…å«"ä½•æ—¶ä½¿ç”¨"çš„è¯´æ˜
- **æ¨¡å—äº’è”** - Agent åˆ©ç”¨ç°æœ‰çš„ frecency/longtail ç³»ç»Ÿ
- **è‡ªç„¶å¯¹è¯** - Agent åƒæœ‹å‹ä¸€æ ·äº¤æµï¼Œä¸æ˜¯æœºå™¨äºº

### å®Œæˆçš„æ¨¡å—äº’è”

#### 1. frecency ç³»ç»Ÿé›†æˆ

- search å·¥å…·æ”¯æŒ `filters.decayStatus` è¿‡æ»¤ï¼ˆactive/cooling/cold/frozenï¼‰
- search å·¥å…·æ”¯æŒ `sortBy: 'frecency'` æŒ‰é‡è¦æ€§æ’åº
- search ç»“æœåŒ…å« `decayStatus` å’Œ `frecency` åˆ†æ•°
- context(overview) æ˜¾ç¤ºæ´»è·ƒåº¦åˆ†å¸ƒç»Ÿè®¡
- context(stats) è¿”å› `decayStats` å’Œ `avgFrecency`

#### 2. FilterTabs è¿‡æ»¤é€»è¾‘é›†æˆ

æ–°å¢ `context(action: 'filter', filterType: ...)` æ”¯æŒï¼š
- `chrome` - Chrome ä¹¦ç­¾è§†å›¾
- `ai_category` - AI åˆ†ç±»è§†å›¾
- `starred` - æ˜Ÿæ ‡ä¹¦ç­¾
- `recent` - æœ€è¿‘è®¿é—®ï¼ˆ7å¤©å†…ï¼‰
- `popular` - çƒ­é—¨ä¹¦ç­¾ï¼ˆæŒ‰è®¿é—®æ¬¡æ•°ï¼‰
- `longtail` - é•¿å°¾ä¹¦ç­¾ï¼ˆcold/frozen çŠ¶æ€ï¼‰
- `trash` - å›æ”¶ç«™

#### 3. System Prompt ç²¾ç®€

ç§»é™¤äº†é‡å¤çš„ Tools Overviewï¼ˆå·¥å…·æè¿°ä¼šé€šè¿‡ function schema è‡ªåŠ¨ä¼ å…¥ï¼‰ï¼Œä¿ç•™ï¼š
- èº«ä»½å®šä¹‰ï¼šAnyMark's bookmark manager
- é¢†åŸŸçŸ¥è¯†ï¼šChrome vs AI æ–‡ä»¶å¤¹ã€Decay statusã€Frecency
- è¡Œä¸ºå‡†åˆ™ï¼šsearch vs discoverã€æ˜¾ç¤ºè·¯å¾„ã€function calling only
